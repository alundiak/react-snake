{"version":3,"sources":["components/Point.tsx","components/Board.tsx","components/SnakeGame.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["Point","gameTrigger","boardState","x","y","isSnake","snake","snakeBegin","restOfSnake","isHead","isTail","some","el","className","targetPoint","onClick","applyAxis","index","FREQUENCY","initialBoardState","boardSize","started","Board","children","useReducer","boardReducer","dispatch","width","height","newDirection","type","interval1","snakeHead","snakeHeadX","snakeHeadY","xDirection","yDirection","i","setInterval","newPosition","isWall","clearInterval","generateRandomPoint","snakeMove","boardCore","push","state","action","console","log","tail","newSnakeHead","newX","Math","floor","random","newY","point","SnakeGame","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.d01f525e.chunk.js","sourcesContent":["import React from 'react';\n\nexport function Point({ gameTrigger, boardState, x, y }: any) {\n\n\tconst isTarget = () => {\n\t\tif (x === boardState.targetPoint[0] && y === boardState.targetPoint[1]) {\n\t\t\treturn 'target';\n\t\t} else {\n\t\t\treturn '';\n\t\t}\n\t}\n\n\tconst isSnake = () => {\n\t\tconst [snakeBegin, ...restOfSnake] = boardState.snake;\n\n\t\tconst isHead = x === snakeBegin[0] && y === snakeBegin[1];\n\t\tconst isTail = restOfSnake.some((el: any) => {\n\t\t\treturn x === el[0] && y === el[1];\n\t\t});\n\n\t\tif (isHead) {\n\t\t\treturn 'snake head';\n\t\t} else if (isTail) {\n\t\t\treturn 'snake tail';\n\t\t} else {\n\t\t\treturn '';\n\t\t}\n\t}\n\n\tconst className = `${isTarget()} ${isSnake()}`;\n\n\tconst onPointClickHandler = (/* e: any */) => {\n\t\treturn !isSnake() ? gameTrigger([x, y]) : null;\n\t};\n\n\treturn <div className={`point ${className}`} onClick={onPointClickHandler}>{applyAxis(x, y)}</div>\n}\n\nfunction applyAxis(x: number, y: number) {\n\tlet index: any = '';\n\n\tif (x === 0 && y === 0) {\n\t\tindex = 0;\n\t} else if (x === 0 && y > 0) {\n\t\tindex = 'y' + y;\n\t} else if (y === 0 && x > 0) {\n\t\tindex = 'x' + x;\n\t}\n\n\treturn index;\n}\n","import React, { useReducer, PropsWithChildren } from 'react';\nimport { Point } from './Point';\nimport './board.css';\n\nconst FREQUENCY = 1000;\n\n// Array for axis used in format [x y] of two positive numbers:\n// y top-to-bottom and\n// x left-to-right\nconst initialBoardState = {\n    boardSize: [8, 8],\n    targetPoint: [2, 3],\n    snake: [[4, 5]],\n    // snake: [[4, 5], [4, 6], [5, 6], [6, 6]],\n    // snake: { // alternative\n    //     head: [],\n    //     tail: []\n    // },\n    started: false,\n    // finished: false,\n    // conflict: false, // target | itself | edge\n};\n\n// Approach using <div> and css-grid layout\nexport function Board({ children }: PropsWithChildren<any>) {\n    const [boardState, dispatch] = useReducer(\n        boardReducer,\n        initialBoardState\n    );\n\n    const width = boardState.boardSize[0];\n    const height = boardState.boardSize[1];\n    // const matrix = Array(width).fill(null).map(el => Array(height).fill(0));\n    // console.log(matrix);\n\n    // This must be created on demand, after click for every cell once. NOT MORE\n    const gameTrigger = (newDirection: number[/* x y */]) => {\n        if (!boardState.started) {\n            dispatch({ type: 'START' });\n        } else {\n            dispatch({ type: 'INTERRUPT' });\n        }\n\n        snakeMove(boardState, newDirection, dispatch);\n    };\n\n    const boardCore = [];\n    for (let x = 0; x < width; x++) {\n        for (let y = 0; y < height; y++) {\n            boardCore.push(<Point gameTrigger={gameTrigger} boardState={boardState} x={x} y={y} key={`cell-x[${x}]-y[${y}]`} />);\n        }\n    }\n\n    return (\n        <>\n            <div className=\"wrapper\">\n                {boardCore}\n            </div>\n            {children}\n        </>\n    );\n}\n\nfunction boardReducer(state: any, action: any) {\n    // console.log('boardReducer'); // TODO\n    // Due to using <React.StrictMode> useReducer() -> reducer() function is double-invoking !!!\n    // https://reactjs.org/docs/strict-mode.html#detecting-unexpected-side-effects\n    // console.log() inside of switch case is once, but random array is regenerated twice\n    // SOLUTION: move ANY logic BEFORE dispatch() and pass any new changed data via dispatch() func.\n    // https://github.com/facebook/react/issues/16295\n    // https://stackoverflow.com/questions/54892403/usereducer-action-dispatched-twice\n\n    switch (action.type) {\n        case 'START':\n            console.log('Game STARTED');\n            return {\n                ...state,\n                started: true // and start while(1) loop OR setInterval()\n            }\n\n        case 'FINISH':\n            console.log('Game Over!');\n\n            return {\n                ...state,\n                started: false, // and stop while(1) loop OR setInterval()\n                // targetPoint: generateRandomPoint('target'), // BAD\n                // snake: [generateRandomPoint('snakeHead')] // BAD\n            }\n\n        case 'SNAKE_MOVE':\n            console.log('Snake is MOVING');\n\n            // state.snake.unshift(action.newDirection);\n            // state.snake.pop(); // add a keyframe animation for slow fade out of last point on tail\n\n            // state.snake[0] = action.newPosition; // MUTABLE !!!!\n\n            // TODO\n            // const [snakeHead, ...snakeTail] = state.snake; // snakeTail can be undefined or many arrays [].length == 2\n            // TODO\n\n            const [, ...tail] = state.snake;\n\n            return {\n                ...state,\n                snake: [action.newPosition, ...tail]\n            }\n\n        case 'CONFLICT_WITH_TARGET':\n            console.log('Target point reached. Generating new one.');\n            // when snake eats target [yT, xT], size should be increased - new sub-array will be pushed to boardState.snake\n\n            // action.newPosition;\n\n            return {\n                ...state,\n                // targetPoint: generateRandomPoint('target'), // BAD\n                // snake: [generateRandomPoint('snakeHead')] // BAD\n            }\n\n        case 'CONFLICT_WITH_ITSELF':\n            console.log('Don\\'t eat yourself');\n\n            return {\n                ...state,\n                // targetPoint: generateRandomPoint('target'), // BAD\n                // snake: [generateRandomPoint('snakeHead')] // BAD\n            }\n\n        case 'CONFLICT_WITH_EDGES':\n            console.log('Bang...');\n\n            return {\n                ...state,\n                started: false,\n                targetPoint: action.newPosition, // SHOULD BE OK\n                snake: [action.newSnakeHead] // SHOULD BE OK\n            }\n\n        case 'REGENERATE_TARGET':\n            console.log('Target point regeneration.');\n\n            return {\n                ...state,\n                targetPoint: action.newPosition, // IS OK\n            }\n\n        case 'REGENERATE_SNAKE':\n            console.log('Snake head point regeneration.');\n\n            return {\n                ...state,\n                snake: [action.newPosition], // IS OK. Will cause disappearing snake's tail, and head will be new point.\n            }\n        case 'INTERRUPT':\n            console.log('INTERRUPT.');\n\n            return {\n                ...state,\n            }\n\n        default:\n            return state;\n    }\n}\n\n/**\n * top: x = const, y--\n * bottom: x = const, y++\n * left: x--, y = const\n * right: x++, y = const\n *\n * @param boardState\n * @param newDirection\n * @param dispatch\n */\nfunction snakeMove(boardState: any, newDirection: any, dispatch: any) {\n    const snakeHead = boardState.snake[0];\n    const [snakeHeadX, snakeHeadY] = snakeHead;\n    const [xDirection, yDirection] = newDirection;\n\n    if (yDirection === snakeHeadY) {\n        // it is LEFT or RIGHT move of snake head\n\n        let interval1: any;\n\n        if (xDirection < snakeHeadX) { // -- loop = LEFT MOVE\n\n            let i = snakeHeadX - 1; // next left point\n\n            const callback = () => {\n                let newPosition = [i, yDirection];\n                if (isWall(newPosition)) {\n                    clearInterval(interval1);\n                    // dispatch({\n                    //     type: 'CONFLICT_WITH_EDGES',\n                    //     newPosition: generateRandomPoint('target'),\n                    //     newSnakeHead: generateRandomPoint('snakeHead')\n                    // });\n                    dispatch({ type: 'FINISH' });\n                    dispatch({ type: 'REGENERATE_TARGET', newPosition: generateRandomPoint('target') });\n                    dispatch({ type: 'REGENERATE_SNAKE', newPosition: generateRandomPoint('snakeHead') });\n                    return;\n                }\n                dispatch({ type: 'SNAKE_MOVE', newPosition });\n                --i; // maybe i--\n            };\n\n            interval1 = setInterval(callback, FREQUENCY);\n        } else { // ++ loop = RIGHT MOVE\n\n            if (interval1) {\n                clearInterval(interval1);\n            }\n\n            // let interval2: any;\n            let i = snakeHeadX + 1; // next right point\n\n            const callback = () => {\n                let newPosition = [i, yDirection];\n                if (isWall(newPosition)) {\n                    clearInterval(interval1);\n                    dispatch({ type: 'FINISH' });\n                    dispatch({ type: 'REGENERATE_TARGET', newPosition: generateRandomPoint('target') });\n                    dispatch({ type: 'REGENERATE_SNAKE', newPosition: generateRandomPoint('snakeHead') });\n                    return;\n                }\n                dispatch({ type: 'SNAKE_MOVE', newPosition });\n                ++i; // maybe i++\n            };\n\n            interval1 = setInterval(callback, FREQUENCY);\n        }\n    } else {\n        // use case when clicked point NOT on the same Y axis\n    }\n\n    if (xDirection === snakeHeadX) {\n        // it is TOP or BOTTOM move\n        if (yDirection < snakeHeadY) {\n            // -- for loop = TOP MOVE\n        } else {\n            // ++ for loop = BOTTOM MOVE\n        }\n    } else {\n        // use case when clicked point NOT on the same X axis\n    }\n\n}\n\nfunction generateRandomPoint(type: string) {\n    const newX = Math.floor(Math.random() * initialBoardState.boardSize[0]);\n    const newY = Math.floor(Math.random() * initialBoardState.boardSize[1]);\n\n    // Extend logic to avoid:\n    // same point as target, which was before\n    // same point of snake head or tail\n    // etc.\n    console.log(type + ' new random point', [newX, newY]);\n\n    return [newX, newY];\n}\n\nfunction isWall(point: number[]) {\n    const [x, y] = point;\n\n    if (x < 0) {\n        return true; // left edge, x has been decreasing towards 0\n    }\n    if (x > initialBoardState.boardSize[0] - 1) {\n        return true; // right edge, x has been increasing from positive number towards board width edge\n    }\n    if (y < 0) {\n        return true; // top edge, y has been decreasing towards 0\n    }\n    if (y > initialBoardState.boardSize[1] - 1) {\n        return true; // right edge, x has been increasing from positive number towards board height edge\n    }\n\n    return false;\n}\n\n","import React from 'react';\nimport { Board } from './Board';\n// import { Point } from './Point';\n// import { Snake } from './Snake';\n\n// import './snake-game.css';\n\n// OR random   Math.random(10, 0);\nexport function SnakeGame() {\n  // dynamics, re-renders, etc\n\n  return (\n    <Board>\n    </Board>\n  );\n}\n","import React from 'react';\nimport { SnakeGame } from './components/SnakeGame';\nimport './App.css';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <header className=\"\">\n      </header>\n      <main>\n        <SnakeGame />\n      </main>\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  // https://stackoverflow.com/questions/54892403/usereducer-action-dispatched-twice\n  // in strict mode, dispatch() from useReducer() was/is executed twice\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}